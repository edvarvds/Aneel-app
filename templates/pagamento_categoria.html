<script>
        async function checkPaymentStatus() {
            try {
                const response = await fetch('/check_payment/{{ pix_data.id }}');
                const data = await response.json();
                console.log('Payment status response:', data);

                if (data.status === 'COMPLETED' || data.status === 'APPROVED' || data.status === 'PAID') {
                    // Atualizar interface para mostrar sucesso
                    document.querySelector('.animate-spin').classList.remove('animate-spin');
                    document.querySelector('svg').style.display = 'none';
                    document.querySelector('h2').textContent = 'Pagamento Confirmado!';

                    // Redirecionar para a página de confirmação
                    window.location.href = '/confirmacao_pagamento/{{ pix_data.id }}';
                    return;
                } else if (data.status === 'FAILED' || data.status === 'CANCELLED' || data.status === 'REJECTED' || data.status === 'ERROR') {
                    document.querySelector('.animate-spin').classList.remove('animate-spin');
                    document.querySelector('svg').style.display = 'none';
                    document.querySelector('h2').textContent = 'Pagamento Falhou';
                    return;
                }

                // Continuar verificando a cada 5 segundos se ainda estiver pendente
                setTimeout(checkPaymentStatus, 5000);
            } catch (error) {
                console.error('Erro ao verificar status:', error);
                setTimeout(checkPaymentStatus, 5000);
            }
        }

        // Iniciar verificação do status
        checkPaymentStatus();
    </script>
